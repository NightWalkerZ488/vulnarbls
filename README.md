# Домашнее задание к занятию "`Уязвимости и атаки на информационные системы`" - `Лоскутов В.В.`
 
---

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.*  

### Ответ:

Сперва просканируем виртуальную машину Meatssploitable c помощью Nmap:


```nmap -sV -sC -p- 192.168.123.7```

![scan](https://github.com/NightWalkerZ488/vulnarbls/blob/main/nmap.PNG)

Видим разрешённые службы:

    FTP (vsftpd 2.3.4)  
    SSH (OpenSSH 4.7p1)  
    Telnet  
    SMB (Samba 3.0.20-Debian)  
    HTTP (Apache + PHP)  
    UnrealIRCd 3.2.8.1  
    MySQL  
    PostgreSQL  
    VNC
     
С помощью сайта "https://www.exploit-db.com/" обнаружены уязвимости: 

1. UnrealIRCd 3.2.8.1 Backdoor Command Execution
   
    Служба: IRC (порт 6667) - вредоносный бэкдор, внедрённый в исходный код UnrealIRCd в 2010 году. Позволяет выполнить произвольные команды.
   
    Exploit-DB: https://www.exploit-db.com/exploits/13853. 
     

2. Samba 3.0.20 < 3.0.25rc3 - Username map script Command Execution
   
    Служба: SMB (порты 139/445) - уязвимость в параметре username map script, позволяющая выполнить команды от имени root.
   
    Exploit-DB: https://www.exploit-db.com/exploits/16320. 
     

3. vsftpd 2.3.4 - Backdoor Command Execution
   
    Служба: FTP (порт 21) - в версии 2.3.4 был внедрён бэкдор, активируемый при отправке определённого имени пользователя.
   
    Exploit-DB: https://www.exploit-db.com/exploits/17491.
     

### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
- Как отвечает сервер?

*Приведите ответ в свободной форме.*

### Ответ:

Для выполнения поставленных задач необходимо запустить на "атакующей" машине Wireshark, и начать захват трафика на интерфейсе, через который имеется связь с metasploitable.

![shark](https://github.com/NightWalkerZ488/vulnarbls/blob/main/shark1.PNG)

Далее, необходимо сканировать различными режимами нашу "цель", а именно машину с ip: 192.168.123.7. 

Для этого вводим команды для различных режимов сканрования:

SYN scan: nmap -sS 192.168.1.105;

FIN scan: nmap -sF 192.168.1.105;

Xmas scan: nmap -sX 192.168.1.105;

UDP scan: nmap -sU 192.168.1.105.

Всё, что происходит во время работы Nmap регистрирует Wireshark.

![scan](https://github.com/NightWalkerZ488/vulnarbls/blob/main/shark2.PNG)

Записи wireshark наглядно показывают, что происходит при каждом режиме сканирования.

Рассмотрим режимы сканирования с точки зрения трафика:

SYN scan - отправляет TCP-пакет с флагом SYN. Если порт открыт — получает SYN-ACK; если закрыт — RST. Не завершает трёхэтапное рукопожатие;

FIN scan - отправляет пакет с флагом FIN. Согласно RFC, закрытые порты должны отвечать RST, открытые — игнорировать;

Xmas scan - аналогично FIN-сканированию: открытые порты — без ответа, закрытые — RST;

UDP scan - отправляет пустой UDP-пакет. Если порт закрыт — может прийти ICMP-сообщение Port Unreachable. Если открыт — либо ответ от службы, либо ничего.

Конкретно в нашем случае, видим, каким образом отвечает "жертва" при каждом типе сканирования:

SYN scan:  открытые порты (21, 22, 80 и др.) отвечают SYN-ACK, закрытые порты RST.
     
FIN scan:  Открытые порты → не отвечают, закрытые порты отправляют RST.
     
Xmas scan: То же, что и FIN, открытые — тишина, закрытые — RST.
     
UDP scan: На открытые UDP-порты может прийти ответ от службы или ничего, на закрытые порты — Metasploitable отправляет ICMP Port Unreachable, кстати многие UDP-сервисы в Metasploitable не отвечают. 

